import{r as u,K as F,j as a,a as e,n as M,F as h,f as g,g as U}from"./app-b9fa2a5c.js";import{A as E}from"./AdminLayout-1bcde9c8.js";import{b as A,d as C}from"./Toast-cb536801.js";import{m as b}from"./fr-0f5c5dd3.js";import{b as p}from"./index.esm-44803543.js";import{D as q}from"./Dropdown-e882e15d.js";import"./FzToastContainer-f656a1dc.js";import"./logo-ec0c8240.js";import"./iconBase-090ce01b.js";b.locale("fr");function O(s){let i=s.auth;const[t,y]=u.useState(s.user);let x=t.name,l=s.authRoleHigh;const[f,k]=u.useState(s.tokenUsers);let m={id:t.id,username:t.name,email:t.email,_token:s.csrf_token};i.permissions.includes("admin.user.money")&&(m.money=t.money),i.permissions.includes("admin.user.ban")&&(m.banned=t.banned);const{data:o,setData:n,post:v,processing:D,errors:z}=F(m);async function N(){const r=Math.max(0,Math.min(999999999,Number(event.target.value)));n("money",r)}const c=[];s.roles.map(r=>{(l.position<r.position||l.level>=5)&&c.push({value:route("admin.users.role.attach",{id:t.id,role:r.id}),method:"get",name:r.name})});async function w(r){r.preventDefault(),v(route("admin.users.edit.save"),{preserveScroll:!0,preserveState:!0,onSuccess:d=>{y(d.props.user)},onError:()=>{}})}async function S(r){U.post(route("admin.users.token.revoke"),r,{preserveState:!0,preserveScroll:!0,resetOnSuccess:!0,onFinish:d=>{},onSuccess:d=>{k(d.props.tokenUsers)},onError:d=>{}})}return a(E,{children:[e(M,{title:x}),a("div",{className:"grid grid-cols-1 px-4 pt-6 xl:grid-cols-3 xl:gap-4 dark:bg-gray-900",children:[e("div",{className:"mb-4 col-span-full xl:mb-2",children:e("h1",{className:"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white",children:"Edition de l'utilisateur"})}),a("div",{className:"col-span-full xl:col-auto",children:[e("div",{className:"p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800",children:a("div",{className:"items-center sm:flex xl:block 2xl:flex sm:space-x-4 xl:space-x-0 2xl:space-x-4",children:[e("img",{className:"mb-4 rounded-lg w-[64px] h-[64px] sm:mb-0 xl:mb-4 2xl:mb-0",src:`https://api.frazionz.net/user/${t.id}/skin/head`,alt:"Jese picture"}),a("div",{className:"flex flex-col gap-1",children:[e("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t.name}),a("div",{className:"flex gap-1 items-center",children:[t.roles.map((r,d)=>e(A,{size:"sm",style:{background:r.color,color:"#fff"},className:"w-fit text-white",children:a("div",{className:"flex items-center gap-2",children:[e("span",{children:r.name}),l.position<r.position&&s.auth.permissions.includes("admin.user.role.edit")&&t.id!==s.auth.user.id&&e(h,{children:t.roles.length>1&&e(g,{href:route("admin.users.role.detach",{id:t.id,role:r.id}),children:e(p,{})})}),l.level>=5&&r.level>=5&&s.auth.permissions.includes("admin.user.role.edit")&&t.id!==s.auth.user.id&&e(h,{children:t.roles.length>1&&e(g,{href:route("admin.users.role.detach",{id:t.id,role:r.id}),children:e(p,{})})})]})},d)),s.roles.length!==0&&s.auth.permissions.includes("admin.user.role.edit")&&t.id!==s.auth.user.id&&e(q,{text:"+",items:c,hideArrow:!0,styleMenu:{top:"36px"},styleButton:{height:"28px",backgroundColor:"rgb(31 41 55/var(--tw-bg-opacity))",width:"fit-content",padding:"12px 6px 16px"}})]})]})]})}),s.auth.permissions.includes("admin.user.session.view")&&e("div",{className:"p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800",children:a("div",{className:"flow-root",children:[e("h3",{className:"text-xl font-semibold dark:text-white",children:"Sessions"}),e("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:f.map((r,d)=>e("li",{className:"py-4",children:a("div",{className:"flex items-center space-x-4",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:"w-6 h-6 dark:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),a("div",{className:"flex-1 min-w-0",children:[a("p",{className:"text-base font-semibold text-gray-900 truncate dark:text-white",children:[r.geo.city," - ",atob(r.ip)]}),a("p",{className:"text-sm font-normal text-gray-500 truncate dark:text-gray-400",children:[r.os," - ",r.useragent]})]}),e("div",{className:"inline-flex items-center",children:e("button",{onClick:()=>S({id:r.id,user_id:t.id}),className:"px-3 py-2 mb-3 mr-3 text-sm font-medium text-center text-gray-900 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 focus:ring-4 focus:ring-primary-300 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",children:"Revoke"})})]})},d))})]})})]}),e("div",{className:"col-span-2",children:a("div",{className:"p-4 mb-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800",children:[e("h3",{className:"mb-4 text-xl font-semibold dark:text-white",children:"Informations Général"}),e("form",{onSubmit:w,children:a("div",{className:"grid grid-cols-6 gap-6",children:[a("div",{className:"col-span-6 sm:col-span-3",children:[e("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Pseudo"}),e("input",{type:"text",onChange:r=>{n("username",r.target.value)},name:"first-name",id:"name",value:o.username,className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Pseudo",required:!0})]}),a("div",{className:"col-span-6 sm:col-span-3",children:[e("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Adresse Email"}),e("input",{type:"email",onChange:r=>{n("email",r.target.value)},name:"email",id:"email",value:o.email,className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Email",required:!0})]}),a("div",{className:"col-span-6 sm:col-span-3",children:[e("label",{htmlFor:"uuid",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"UUID"}),e("input",{type:"text",name:"uuid",id:"uuid",disabled:!0,value:t.uuid,className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"N/A",required:!0})]}),i.permissions.includes("admin.user.money")&&a("div",{className:"col-span-6 sm:col-span-3",children:[e("label",{htmlFor:"money",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Points boutique"}),e("input",{type:"number",onChange:N,name:"money",id:"money",value:o.money,className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"N/A",required:!0})]}),i.permissions.includes("admin.user.ban")&&a("div",{className:"col-span-6 sm:col-span-3",children:[e("label",{htmlFor:"role",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Est bannis ?"}),a(C,{onChange:r=>{n("banned",r.target.value)},value:o.banned,required:!0,children:[e("option",{value:"1",children:"Oui"}),e("option",{value:"0",children:"Non"})]})]}),a("div",{className:"col-span-6 sm:col-span-3",children:[e("label",{htmlFor:"createdat",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Inscrit depuis le"}),e("input",{type:"text",name:"createdat",id:"createdat",disabled:!0,value:b(t.created_at).local("fr").tz("Europe/Paris").format("D MMMM YYYY"),className:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"N/A",required:!0})]}),e("div",{className:"col-span-6 sm:col-full",children:e("button",{className:"text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800",type:"submit",children:"Sauvegarder"})})]})})]})})]})]})}export{O as default};
