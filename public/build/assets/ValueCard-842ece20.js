import{r as e,b as j,g as v,j as S,a as m}from"./app-96305860.js";import{u as M,s as F,a as _,P as $,L as T,m as w}from"./motion-473fad4c.js";function O(){const s=e.useRef(!1);return M(()=>(s.current=!0,()=>{s.current=!1}),[]),s}function U(){const s=O(),[n,t]=e.useState(0),r=e.useCallback(()=>{s.current&&t(n+1)},[n]);return[e.useCallback(()=>F.postRender(r),[r]),n]}class V extends e.Component{getSnapshotBeforeUpdate(n){const t=this.props.childRef.current;if(t&&n.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function A({children:s,isPresent:n}){const t=e.useId(),r=e.useRef(null),h=e.useRef({width:0,height:0,top:0,left:0});return e.useInsertionEffect(()=>{const{width:l,height:c,top:a,left:g}=h.current;if(n||!r.current||!l||!c)return;r.current.dataset.motionPopId=t;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            top: ${a}px !important;
            left: ${g}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[n]),e.createElement(V,{isPresent:n,childRef:r,sizeRef:h},e.cloneElement(s,{ref:r}))}const b=({children:s,initial:n,isPresent:t,onExitComplete:r,custom:h,presenceAffectsLayout:l,mode:c})=>{const a=_(K),g=e.useId(),d=e.useMemo(()=>({id:g,initial:n,isPresent:t,custom:h,onExitComplete:u=>{a.set(u,!0);for(const o of a.values())if(!o)return;r&&r()},register:u=>(a.set(u,!1),()=>a.delete(u))}),l?void 0:[t]);return e.useMemo(()=>{a.forEach((u,o)=>a.set(o,!1))},[t]),e.useEffect(()=>{!t&&!a.size&&r&&r()},[t]),c==="popLayout"&&(s=e.createElement(A,{isPresent:t},s)),e.createElement($.Provider,{value:d},s)};function K(){return new Map}function G(s){return e.useEffect(()=>()=>s(),[])}const C=s=>s.key||"";function B(s,n){s.forEach(t=>{const r=C(t);n.set(r,t)})}function D(s){const n=[];return e.Children.forEach(s,t=>{e.isValidElement(t)&&n.push(t)}),n}const H=({children:s,custom:n,initial:t=!0,onExitComplete:r,exitBeforeEnter:h,presenceAffectsLayout:l=!0,mode:c="sync"})=>{h&&(c="wait");let[a]=U();const g=e.useContext(T).forceRender;g&&(a=g);const d=O(),u=D(s);let o=u;const f=new Set,x=e.useRef(o),y=e.useRef(new Map).current,E=e.useRef(!0);if(M(()=>{E.current=!1,B(u,y),x.current=o}),G(()=>{E.current=!0,y.clear(),f.clear()}),E.current)return e.createElement(e.Fragment,null,o.map(i=>e.createElement(b,{key:C(i),isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:l,mode:c},i)));o=[...o];const R=x.current.map(C),k=u.map(C),P=R.length;for(let i=0;i<P;i++){const p=R[i];k.indexOf(p)===-1&&f.add(p)}return c==="wait"&&f.size&&(o=[]),f.forEach(i=>{if(k.indexOf(i)!==-1)return;const p=y.get(i);if(!p)return;const z=R.indexOf(i),I=()=>{y.delete(i),f.delete(i);const L=x.current.findIndex(N=>N.key===i);if(x.current.splice(L,1),!f.size){if(x.current=u,d.current===!1)return;a(),r&&r()}};o.splice(z,0,e.createElement(b,{key:C(p),isPresent:!1,onExitComplete:I,custom:n,presenceAffectsLayout:l,mode:c},p))}),o=o.map(i=>{const p=i.key;return f.has(p)?i:e.createElement(b,{key:C(i),isPresent:!0,presenceAffectsLayout:l,mode:c},i)}),e.createElement(e.Fragment,null,f.size?o:o.map(i=>e.cloneElement(i)))};class W extends j.Component{constructor(n){super(n),this.state={isOpen:!1},this.title=n.title,this.value=n.value,this.callSave=n.callSave,this.icon=n.icon,this.link=n.href}async formSubmitPut(){let n=!1;Object.entries(this.props.data).map(t=>{if(t[0]!=="_token"&&t[1]!==""){console.log(t[1]),n=!0;return}}),n&&v.put(this.props.url,this.props.data,{preserveScroll:!0,onSuccess:()=>{v.reload()}})}render(){return S("div",{className:"card",children:[S("div",{className:"head",children:[S("div",{className:"infos",children:[m("img",{src:this.icon,width:"32",height:"32",alt:""}),m("span",{children:this.title}),m("span",{className:"text-[var(--text-inactive)]",children:this.value})]}),m("div",{className:"actions",children:m(w.button,{whileTap:{scale:.97},className:"btn",onClick:()=>{this.link!==void 0?v.get(this.link):(this.state.isOpen&&this.props.method=="put"&&this.formSubmitPut(),this.setState({isOpen:!this.state.isOpen}))},children:this.state.isOpen?"Sauvegarder":"Modifier"})})]}),m(H,{initial:!1,children:this.state.isOpen&&m(w.section,{className:"content",initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},transition:{duration:.2,ease:[.04,.62,.23,.98]},children:this.props.children},"content")})]})}}const Q=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{H as A,W as V,Q as a};
