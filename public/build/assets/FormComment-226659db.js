import{W as _,_ as k,r as t,j as f,a as e,g as D}from"./app-3a3ebf9f.js";import{F as T}from"./FzToast-34c64f0c.js";import{D as r,d as j,r as F}from"./draftjs-to-html-d336538f.js";import"./bubble_warning-9cee2399.js";import"./bubble_infos-3d3cb710.js";function q({thread:a,setThread:h,afterCommentPublish:E}){const m=_().props,{data:N,setData:R,post:w,processing:S,errors:I}=k({th_id:a.id,comment:"",_token:m.csrf_token}),[g,P]=t.useState(a.id),[i,o]=t.useState(r.EditorState.createEmpty()),c=j(r.convertToRaw(i.getCurrentContent())),[s,y]=t.useState(c),[b,V]=t.useState(m.csrf_token);function x(){return s.replace(/<(.|\n)*?>/g,"").trim().length===0&&!s.includes("<img")}const v=n=>{o(n),y(c)};async function C(n){if(n.preventDefault(),x()){T.error("Votre commentaire est vide.");return}D.post(route("forum.thread.comment.publish"),{th_id:g,acomment:s,_token:b},{preserveScroll:!0,onSuccess:p=>{var l,d,u;h((l=p.props.flash)==null?void 0:l.dataReset),o(r.EditorState.createEmpty()),E((u=(d=p.props.flash)==null?void 0:d.dataReset)==null?void 0:u.comments)},onError:()=>{o(r.EditorState.createEmpty())}})}return f("form",{onSubmit:C,className:"flex flex-col gap-5",children:[f("div",{className:"form-group",children:[e("label",{children:"Votre commentaire"}),e("div",{children:e(F.Editor,{editorState:i,onEditorStateChange:v,toolbar:{}})})]}),e("button",{type:"submit",disabled:S,className:"flex justify-center btn",children:"Envoyer"})]})}export{q as default};
