import{r as l,j as r,a as t,b as X,F as ee,g as V}from"./app-f2c1dcf3.js";import{L as te,B as ae}from"./Layout-f88fab4a.js";import{B as D}from"./Badge-0f6c05b0.js";import{M as re}from"./index-05b06661.js";import{L as ie}from"./Language-45cbb11a.js";import{P as G}from"./Paginate-ec3e77da.js";import{e as o}from"./Toast-61fae8fb.js";import{S as ne}from"./Spinner-fd10a4bc.js";import{t as W}from"./index-e3d2c47e.js";import{m as c}from"./fr-e29cf34f.js";import oe from"./FormComment-621754a8.js";import{A as $}from"./Alert-b77699c7.js";import{G as O}from"./iconBase-a5111a0f.js";import{a as le,b as se}from"./index.esm-a7e631d7.js";import"./logo-5fe7a993.js";import"./dropdownProfile-b06ecd60.js";import"./motion-717cad6e.js";import"./Dropdown-56dd5105.js";import"./index.esm-ed3f49d6.js";import"./commentForum-5f640902.js";import"./keyboard-37ea7428.js";import"./transition-b47411f0.js";import"./index-ad022a32.js";import"./FzToastContainer-06d753c4.js";import"./FzToast-28d850b3.js";import"./bubble_warning-9cee2399.js";import"./bubble_infos-3d3cb710.js";/* empty css            */import"./twitch-ccb5fb5c.js";import"./draftjs-to-html-cda25c47.js";import"./index-4d501b15.js";function ce(i){return O({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M3 3l18 18"}},{tag:"path",attr:{d:"M15 4.5l-3.249 3.249m-2.57 1.433l-2.181 .818l-1.5 1.5l7 7l1.5 -1.5l.82 -2.186m1.43 -2.563l3.25 -3.251"}},{tag:"path",attr:{d:"M9 15l-4.5 4.5"}},{tag:"path",attr:{d:"M14.5 4l5.5 5.5"}}]})(i)}function de(i){return O({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}},{tag:"path",attr:{d:"M12 16l0 5"}},{tag:"path",attr:{d:"M8 4l8 0"}}]})(i)}c.locale("fr");function De(i){var M,x,N,y,S,_,z,L,P,H,T,Y,F;const[e,d]=l.useState(i.thread),p="Forum",u=new ie(i.Language);new re;const v=i.auth.permissions,[n,h]=l.useState((x=(M=i.thread)==null?void 0:M.comments)==null?void 0:x.data),[s,m]=l.useState((N=i.thread)==null?void 0:N.comments),[U,k]=l.useState(!v.includes("forum.thread.pinned")),[Z,b]=l.useState(!v.includes("forum.thread.locked"));async function q(a){m(a),h(a==null?void 0:a.data)}async function J(){k(!0),V.post(route("forum.thread.actions.pinned"),{th_id:e.id,_token:i.csrf_token},{onFinish:()=>{k(!1)},onSuccess:a=>{d(a.props.thread)}})}async function K(){b(!0),V.post(route("forum.thread.actions.locked"),{th_id:e.id,_token:i.csrf_token},{onFinish:()=>{b(!1)},onSuccess:a=>{d(a.props.thread)}})}async function Q(){navigator.share({title:"FrazionZ - Forum",text:e==null?void 0:e.title,url:route("forum.thread.view",{th_id:e==null?void 0:e.id})}).then(()=>{}).catch(a=>{})}l.useEffect(()=>{},[e]);let f=W(e==null?void 0:e.content);return f=new TextDecoder().decode(f),r(te,{props:i,title:p,header:t("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:p}),children:[t(X,{title:p}),r("div",{className:"forum thread",children:[r("div",{className:"actions",children:[t("span",{className:"text-4xl",children:e==null?void 0:e.title}),r("div",{className:"flex gap-3",children:[t("button",{className:"btn icon",disabled:U,onClick:J,children:e!=null&&e.pinned?t(o,{content:"Désépingler",children:t(ce,{})}):t(o,{content:"Epingler",children:t(de,{})})}),t("button",{className:"btn icon",disabled:Z,onClick:K,children:e!=null&&e.locked?t(o,{content:"Dévérouiller",children:t(se,{})}):t(o,{content:"Vérouiller",children:t(le,{})})}),t("button",{className:"btn icon",onClick:Q,children:t(o,{content:"Partager ce thread",children:t(ae,{})})})]})]}),r("div",{className:"card vertical",children:[r("div",{className:"profile",children:[t("div",{className:"avatar",children:t("img",{src:`https://auth.frazionz.net/skins/face.php?u=${e.author.id}`,alt:"avatar"})}),r("div",{className:"details",children:[t("span",{children:e.author.name}),t(D,{styleBadge:{backgroundColor:(_=(S=(y=e==null?void 0:e.author)==null?void 0:y.role)==null?void 0:S.badgeStyle)==null?void 0:_.background,padding:"0px 6px",display:"flex"},styleMessage:{fontSize:"10px",lineHeight:"20px",color:(P=(L=(z=e==null?void 0:e.author)==null?void 0:z.role)==null?void 0:L.badgeStyle)==null?void 0:P.color},message:(T=(H=e==null?void 0:e.author)==null?void 0:H.role)==null?void 0:T.name})]}),r("div",{className:"grid",children:[r("span",{children:["Rejoins ",t("b",{children:u.replaceMonth(c((Y=e==null?void 0:e.author)==null?void 0:Y.created_at).local("fr").tz("Europe/Paris").format("D MMMM YYYY à HH:mm"))})]}),t(o,{content:"Messages totaux par cet utilisateur",children:r("span",{children:["Messages ",t("b",{children:(F=e==null?void 0:e.author)==null?void 0:F.messages})]})})]}),r("div",{className:"grid",children:[t(o,{content:"Réponses totaux sur ce thread",children:r("span",{children:["Réponse(s) ",t("b",{children:s==null?void 0:s.total})]})}),r("span",{children:["Publié le ",t("b",{children:u.replaceMonth(c(e==null?void 0:e.created_at).local("fr").tz("Europe/Paris").format("D MMMM YYYY à HH:mm"))})]})]})]}),t("div",{className:"thread",children:t("div",{dangerouslySetInnerHTML:{__html:f}})})]}),r("div",{className:"flex flex-col gap-5",children:[(n==null?void 0:n.length)<=0&&t($,{state:"infos",children:"Aucun commentaire n'a été posté"}),(n==null?void 0:n.length)>0&&r(ee,{children:[t(G,{layout:"top",labelType:"Commentaires",routeName:"forum.thread.comment.paginate",pagination:s,setList:h,setPagination:m,parent_id:e==null?void 0:e.id}),n==null&&r("div",{className:"flex justify-center gap-3 mt-4 mb-4",children:[t(ne,{size:"md"})," Veuillez patienter"]}),n==null?void 0:n.map((a,B)=>{var C,A,j,E,w,I,R;let g=W(a.content);return g=new TextDecoder().decode(g),r("div",{className:"card horizontal",children:[r("div",{className:"profile",children:[r("div",{className:"flex gap-4 items-center",children:[t("div",{className:"avatar",children:t("img",{src:`https://auth.frazionz.net/skins/face.php?u=${a.author.id}`,alt:"avatar"})}),r("div",{className:"details",children:[t("span",{children:a.author.name}),t(D,{styleBadge:{backgroundColor:(j=(A=(C=a==null?void 0:a.author)==null?void 0:C.role)==null?void 0:A.badgeStyle)==null?void 0:j.background,padding:"0px 6px",display:"flex"},styleMessage:{color:(I=(w=(E=a==null?void 0:a.author)==null?void 0:E.role)==null?void 0:w.badgeStyle)==null?void 0:I.color,fontSize:"10px",lineHeight:"20px"},message:(R=a==null?void 0:a.author)==null?void 0:R.role.name},B)]})]}),t("div",{className:"grid",children:r("span",{children:["Publié le ",t("br",{}),t("b",{children:u.replaceMonth(c(a==null?void 0:a.created_at).local("fr").tz("Europe/Paris").format("D MMMM YYYY à HH:mm"))})]})})]}),t("div",{className:"thread",dangerouslySetInnerHTML:{__html:g}})]},B)}),t(G,{layout:"bottom",labelType:"Commentaires",routeName:"forum.thread.comment.paginate",pagination:s,setList:h,setPagination:m,parent_id:e==null?void 0:e.id})]})]}),(e==null?void 0:e.locked)==!0&&t($,{state:"infos",children:"Ce thread a été vérouillé, vous ne pouvez plus commenter"}),(e==null?void 0:e.locked)==!1&&t(oe,{thread:e,setThread:d,afterCommentPublish:q})]})]})}export{De as default};
