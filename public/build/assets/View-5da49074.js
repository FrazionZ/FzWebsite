import{r as l,j as r,a as t,n as Q,F as X,g as V}from"./app-672b5057.js";import{L as ee,B as te}from"./Layout-3ca0b6bc.js";import{B as G}from"./Badge-2351a8f7.js";import{M as ae}from"./index-f140edf0.js";import{L as re}from"./Language-45cbb11a.js";import{P as W}from"./Paginate-3d9907ee.js";import{e as o}from"./Toast-e31acce0.js";import{S as ie}from"./Spinner-2cb72485.js";import{t as ne}from"./index-e3d2c47e.js";import{m as c}from"./fr-4635b133.js";import oe from"./FormComment-2b70c19f.js";import{A as $}from"./Alert-81a8af72.js";import{G as D}from"./iconBase-50bc53c2.js";import{a as le,b as se}from"./index.esm-1d176687.js";import"./logo-ec0c8240.js";import"./FzToastContainer-cac936b9.js";import"./FzToast-684b824e.js";import"./bubble_warning-9cee2399.js";import"./bubble_infos-3d3cb710.js";import"./motion-8d78cff3.js";import"./Dropdown-9b0b5663.js";import"./index.esm-5374c5b9.js";import"./commentForum-5f640902.js";import"./keyboard-f708b31e.js";import"./transition-a48ecbed.js";import"./index-7614422b.js";/* empty css            */import"./twitch-bbd8d24a.js";import"./Editor-5b8bc3f2.js";import"./objectWithoutPropertiesLoose-df62547b.js";import"./index-4d501b15.js";import"./index-71931d8b.js";function ce(i){return D({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M3 3l18 18"}},{tag:"path",attr:{d:"M15 4.5l-3.249 3.249m-2.57 1.433l-2.181 .818l-1.5 1.5l7 7l1.5 -1.5l.82 -2.186m1.43 -2.563l3.25 -3.251"}},{tag:"path",attr:{d:"M9 15l-4.5 4.5"}},{tag:"path",attr:{d:"M14.5 4l5.5 5.5"}}]})(i)}function de(i){return D({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M9 4v6l-2 4v2h10v-2l-2 -4v-6"}},{tag:"path",attr:{d:"M12 16l0 5"}},{tag:"path",attr:{d:"M8 4l8 0"}}]})(i)}c.locale("fr");function We(i){var M,x,N,y,S,_,z,L,P,H,Y,F,T;const[e,d]=l.useState(i.thread),p="Forum",u=new re(i.Language),g=new ae,v=i.auth.permissions,[n,h]=l.useState((x=(M=i.thread)==null?void 0:M.comments)==null?void 0:x.data),[s,m]=l.useState((N=i.thread)==null?void 0:N.comments),[O,k]=l.useState(!v.includes("forum.thread.pinned")),[U,b]=l.useState(!v.includes("forum.thread.locked"));async function Z(a){m(a),h(a==null?void 0:a.data)}async function q(){k(!0),V.post(route("forum.thread.actions.pinned"),{th_id:e.id,_token:i.csrf_token},{onFinish:()=>{k(!1)},onSuccess:a=>{d(a.props.thread)}})}async function J(){b(!0),V.post(route("forum.thread.actions.locked"),{th_id:e.id,_token:i.csrf_token},{onFinish:()=>{b(!1)},onSuccess:a=>{d(a.props.thread)}})}async function K(){navigator.share({title:"FrazionZ - Forum",text:e==null?void 0:e.title,url:route("forum.thread.view",{th_id:e==null?void 0:e.id})}).then(()=>{}).catch(a=>{})}return l.useEffect(()=>{},[e]),r(ee,{props:i,title:p,header:t("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:p}),children:[t(Q,{title:p}),r("div",{className:"forum thread",children:[r("div",{className:"actions",children:[t("span",{className:"text-4xl",children:e==null?void 0:e.title}),r("div",{className:"flex gap-3",children:[t("button",{className:"btn icon",disabled:O,onClick:q,children:e!=null&&e.pinned?t(o,{content:"Désépingler",children:t(ce,{})}):t(o,{content:"Epingler",children:t(de,{})})}),t("button",{className:"btn icon",disabled:U,onClick:J,children:e!=null&&e.locked?t(o,{content:"Dévérouiller",children:t(se,{})}):t(o,{content:"Vérouiller",children:t(le,{})})}),t("button",{className:"btn icon",onClick:K,children:t(o,{content:"Partager ce thread",children:t(te,{})})})]})]}),r("div",{className:"card vertical",children:[r("div",{className:"profile",children:[t("div",{className:"avatar",children:t("img",{src:`https://auth.frazionz.net/skins/face.php?u=${e.author.id}`,alt:"avatar"})}),r("div",{className:"details",children:[t("span",{children:e.author.name}),t(G,{styleBadge:{backgroundColor:(_=(S=(y=e==null?void 0:e.author)==null?void 0:y.role)==null?void 0:S.badgeStyle)==null?void 0:_.background,padding:"0px 6px",display:"flex"},styleMessage:{fontSize:"10px",lineHeight:"20px",color:(P=(L=(z=e==null?void 0:e.author)==null?void 0:z.role)==null?void 0:L.badgeStyle)==null?void 0:P.color},message:(Y=(H=e==null?void 0:e.author)==null?void 0:H.role)==null?void 0:Y.name})]}),r("div",{className:"grid",children:[r("span",{children:["Rejoins ",t("b",{children:u.replaceMonth(c((F=e==null?void 0:e.author)==null?void 0:F.created_at).local("fr").tz("Europe/Paris").format("D MMMM YYYY à HH:mm"))})]}),t(o,{content:"Messages totaux par cet utilisateur",children:r("span",{children:["Messages ",t("b",{children:(T=e==null?void 0:e.author)==null?void 0:T.messages})]})})]}),r("div",{className:"grid",children:[t(o,{content:"Réponses totaux sur ce thread",children:r("span",{children:["Réponse(s) ",t("b",{children:s==null?void 0:s.total})]})}),r("span",{children:["Publié le ",t("b",{children:u.replaceMonth(c(e==null?void 0:e.created_at).local("fr").tz("Europe/Paris").format("D MMMM YYYY à HH:mm"))})]})]})]}),t("div",{className:"thread",children:t("div",{dangerouslySetInnerHTML:{__html:g.render(atob(e==null?void 0:e.content))}})})]}),r("div",{className:"flex flex-col gap-5",children:[(n==null?void 0:n.length)<=0&&t($,{state:"infos",children:"Aucun commentaire n'a été posté"}),(n==null?void 0:n.length)>0&&r(X,{children:[t(W,{layout:"top",labelType:"Commentaires",routeName:"forum.thread.comment.paginate",pagination:s,setList:h,setPagination:m,parent_id:e==null?void 0:e.id}),n==null&&r("div",{className:"flex justify-center gap-3 mt-4 mb-4",children:[t(ie,{size:"md"})," Veuillez patienter"]}),n==null?void 0:n.map((a,B)=>{var C,A,j,E,I,w,R;let f=ne(a.content);return f=new TextDecoder().decode(f),r("div",{className:"card horizontal",children:[r("div",{className:"profile",children:[r("div",{className:"flex gap-4 items-center",children:[t("div",{className:"avatar",children:t("img",{src:`https://auth.frazionz.net/skins/face.php?u=${a.author.id}`,alt:"avatar"})}),r("div",{className:"details",children:[t("span",{children:a.author.name}),t(G,{styleBadge:{backgroundColor:(j=(A=(C=a==null?void 0:a.author)==null?void 0:C.role)==null?void 0:A.badgeStyle)==null?void 0:j.background,padding:"0px 6px",display:"flex"},styleMessage:{color:(w=(I=(E=a==null?void 0:a.author)==null?void 0:E.role)==null?void 0:I.badgeStyle)==null?void 0:w.color,fontSize:"10px",lineHeight:"20px"},message:(R=a==null?void 0:a.author)==null?void 0:R.role.name},B)]})]}),t("div",{className:"grid",children:r("span",{children:["Publié le ",t("br",{}),t("b",{children:u.replaceMonth(c(a==null?void 0:a.created_at).local("fr").tz("Europe/Paris").format("D MMMM YYYY à HH:mm"))})]})})]}),t("div",{className:"thread",dangerouslySetInnerHTML:{__html:g.render(f)}})]},B)}),t(W,{layout:"bottom",labelType:"Commentaires",routeName:"forum.thread.comment.paginate",pagination:s,setList:h,setPagination:m,parent_id:e==null?void 0:e.id})]})]}),(e==null?void 0:e.locked)==!0&&t($,{state:"infos",children:"Ce thread a été vérouillé, vous ne pouvez plus commenter"}),(e==null?void 0:e.locked)==!1&&t(oe,{thread:e,setThread:d,afterCommentPublish:Z})]})]})}export{We as default};
